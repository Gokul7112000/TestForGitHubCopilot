# This workflow builds the ChromaCascade game and displays a success message
# when code is pushed to the main branch.

name: 'Build ChromaCascade'

on:
  push:
    branches:
      - main

jobs:
  build:
    name: 'Build and Validate'
    runs-on: 'ubuntu-latest'

    steps:
      - name: 'Checkout Code'
        uses: 'actions/checkout@v4'

      - name: 'Verify Project Files'
        run: |
          echo "üîç Verifying project structure..."
          
          # Check for required files
          files=("index.html" "game.js" "tetromino.js" "renderer.js" "main.js" "styles.css")
          all_files_exist=true
          
          for file in "${files[@]}"; do
            if [ -f "$file" ]; then
              echo "‚úÖ Found: $file"
            else
              echo "‚ùå Missing: $file"
              all_files_exist=false
            fi
          done
          
          if [ "$all_files_exist" = true ]; then
            echo "‚úÖ All required files present"
          else
            echo "‚ùå Some required files are missing"
            exit 1
          fi

      - name: 'Build Success Message'
        run: |
          echo "================================================"
          echo "üéÆ ChromaCascade Build Successful! üéÆ"
          echo "================================================"
          echo ""
          echo "‚úÖ Build completed successfully"
          echo "‚úÖ All game files validated"
          echo "‚úÖ Ready for deployment"
          echo ""
          echo "Game Features:"
          echo "  ‚Ä¢ Tetris-style block dropping"
          echo "  ‚Ä¢ Color-matching mechanics"
          echo "  ‚Ä¢ Cascade system with combos"
          echo "  ‚Ä¢ Progressive difficulty"
          echo ""
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "Commit: ${{ github.sha }}"
          echo "Author: ${{ github.actor }}"
          echo ""
          echo "================================================"

      - name: 'Send Success Email'
        uses: 'dawidd6/action-send-mail@v3'
        with:
          server_address: smtp.gmail.com
          server_port: 587
          username: ${{ secrets.MAIL_USERNAME }}
          password: ${{ secrets.MAIL_PASSWORD }}
          subject: 'Vanakam da Mapla build successfull'
          to: vadivel.gokul@in.bosch.com
          from: ChromaCascade Build System
          body: |
            Vanakam da Mapla build successfull! üéÆ
            
            ChromaCascade build has completed successfully!
            
            Build Details:
            - Repository: ${{ github.repository }}
            - Branch: ${{ github.ref_name }}
            - Commit: ${{ github.sha }}
            - Author: ${{ github.actor }}
            - Workflow: ${{ github.workflow }}
            
            All game files have been validated and the build is ready!
            
            Game Features:
            ‚Ä¢ Tetris-style block dropping
            ‚Ä¢ Color-matching mechanics
            ‚Ä¢ Cascade system with combos
            ‚Ä¢ Progressive difficulty
            
            View the workflow run: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
            
            Happy Gaming! üéÆ‚ú®
